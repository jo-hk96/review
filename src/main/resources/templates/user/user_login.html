<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" 
                  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>ë¡œê·¸ì¸í¼</title>
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="/css/user_login.css">
</head>
<body>
		<h1>ë¡œê·¸ì¸</h1>
			<form action = "/UserLogin" method = "post" id="loginForm">
			    <input type ="email" id="email" name="email" placeholder = "ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.">
			    <span id="emailError" style="color: red; font-size: 0.9em;"></span><br> 
			
			    <input type = "password" name ="password" id="password"  placeholder = "ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.">
			    <span id="passwordError" style="color: red; font-size: 0.9em;"></span><br> 
			    
			    <button type = "submit" >ë¡œê·¸ì¸</button>
			</form>

	<div class ="userIndex" sec:authorize="isAnonymous()">
	<a href = "/UserJoinForm" class="btn-join">íšŒì›ê°€ì…</a> </div>


	<div th:insert="index/index :: footer"></div>

      <script>
			document.addEventListener('DOMContentLoaded', function() {
		    const form = document.getElementById('loginForm');
		
		    // ì´ë©”ì¼ ê´€ë ¨ ìš”ì†Œ
		    const emailInput = document.getElementById('email');
		    const emailError = document.getElementById('emailError');
		    const emailRegex = /^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i;
		
		    // ë¹„ë°€ë²ˆí˜¸ ê´€ë ¨ ìš”ì†Œ
		    const passwordInput = document.getElementById('password');
		    const passwordError = document.getElementById('passwordError');
		
		    /**
		     * ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬ (ë¹ˆ ê°’ ë° í˜•ì‹ ì²´í¬)
		     * ë°˜í™˜ ê°’: 0(ë¹„ì–´ìˆìŒ), 1(í˜•ì‹ ì˜¤ë¥˜), 2(ìœ íš¨í•¨)
		     */
		    function validateEmail() {
		        const emailValue = emailInput.value.trim();
		
		        if (emailValue === "") {
		            emailError.textContent = "ì´ë©”ì¼ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
		            return 0; // ë¹„ì–´ ìˆìŒ
		        } else if (!emailRegex.test(emailValue)) {
		            emailError.textContent = "ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.";
		            return 1; // í˜•ì‹ ì˜¤ë¥˜
		        } else {
		            emailError.textContent = "";
		            return 2; // ìœ íš¨í•¨
		        }
		    }
		
		    /**
		     * ë¹„ë°€ë²ˆí˜¸ ë¹ˆ ê°’ ê²€ì‚¬
		     * ë°˜í™˜ ê°’: 0(ë¹„ì–´ìˆìŒ), 2(ìœ íš¨í•¨)
		     */
		    function validatePassword() {
		        const passwordValue = passwordInput.value.trim();
		
		        if (passwordValue === "") {
		            passwordError.textContent = "ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
		            return 0; // ë¹„ì–´ ìˆìŒ
		        } else {
		            // ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ ê²€ì‚¬ ìš”ì²­ì´ ì—†ìœ¼ë¯€ë¡œ, ë¹„ì–´ ìˆì§€ ì•Šìœ¼ë©´ ìœ íš¨í•œ ê²ƒìœ¼ë¡œ ì²˜ë¦¬
		            passwordError.textContent = "";
		            return 2; // ìœ íš¨í•¨
		        }
		    }
		
		    // --- í¼ ì œì¶œ(Submit) ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
		    form.addEventListener('submit', function(event) {
		        // 1. ìœ íš¨ì„± ê²€ì‚¬ ì‹¤í–‰
		        const emailValidationResult = validateEmail();
		        const passwordValidationResult = validatePassword();
		
		        // 2. í•˜ë‚˜ë¼ë„ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ í¼ ì œì¶œ ì¤‘ì§€ ë° alert ì‹¤í–‰
		        if (emailValidationResult !== 2 || passwordValidationResult !== 2) {
		            event.preventDefault(); // í¼ ì œì¶œ ì¤‘ì§€
		
		            // ---ë¹„ì–´ ìˆì„ ë•Œ alert ë©”ì‹œì§€ (ìš°ì„ ìˆœìœ„ ë†’ìŒ) ---
		            if (emailValidationResult === 0) {
		                alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
		                emailInput.focus();
		                return;
		            }
		
		            if (passwordValidationResult === 0) {
		                alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
		                passwordInput.focus();
		                return;
		            }
		
		            // --- ğŸš¨ í˜•ì‹ ì˜¤ë¥˜ alert ë©”ì‹œì§€ (ë¹ˆ ê°’ì´ ì•„ë‹ ë•Œ) ---
		            if (emailValidationResult === 1) {
		                alert('ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
		                emailInput.focus();
		                return;
		            }
		
		            // ë¹„ë°€ë²ˆí˜¸ëŠ” ë¹ˆ ê°’ì´ ì•„ë‹ˆë©´ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼í•˜ë„ë¡ ìš”ì²­í–ˆìœ¼ë¯€ë¡œ,
		            // ë³„ë„ì˜ ê¸¸ì´/í˜•ì‹ ì˜¤ë¥˜ alertëŠ” í•„ìš” ì—†ìŠµë‹ˆë‹¤.
		            return;
		        }
		        // ëª¨ë“  ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µê³¼í•˜ë©´ í¼ì´ ì •ìƒì ìœ¼ë¡œ ì œì¶œë©ë‹ˆë‹¤.
		    });
		
		    // blur ì´ë²¤íŠ¸ëŠ” spanì—ë§Œ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í‘œì‹œ
		    emailInput.addEventListener('blur', validateEmail);
		    passwordInput.addEventListener('blur', validatePassword);
		});
</script>
</body>
</html>